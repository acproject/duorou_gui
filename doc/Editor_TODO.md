# UI 编辑器（QtCreator 风格）开发 Todo

目标：实现一个可实时编辑 UI 样式、支持主题与热加载、具备样式溯源调试能力的编辑器，用于验证 Style 系统、解析器、运行时与刷新机制的正确性。

工程位置：`d:\workspace\cpp_projects\duorou_gui\editor`

## 里程碑与任务

### M0：工程落地（Editor 工程可编译运行）
- [x] 建立 `editor/` 子工程（CMake/源码入口/资源目录）
- [x] 设计编辑器窗口的基础布局（组件树 / 中央预览 / 样式面板）
- [x] 引入运行时 UI 框架（复用现有 duorou::ui 组件体系）
- [x] 增加编辑区域（可输入文本，验证 binding/焦点/选区）

### M1：Style 数据模型（可表达层级与属性）
- [x] 定义 Style 层级模型：Global / Component / Variant / State
- [x] 定义查找顺序：State → Variant → Component → Global
- [x] 定义主题模型：Theme(name, base) 与主题继承链
- [x] 定义属性表示与类型系统（颜色/字体/间距等）

### M2：样式解析器（TOML / JSON）
- [x] 设计样式文件结构与最小示例（覆盖 Button / Text / Input）
- [x] 实现 TOML 解析加载（含错误定位与容错策略）
- [x] 实现 JSON 解析加载（与 TOML 一致的语义）
- [x] 解析结果映射到统一 Style 数据模型

### M3：StyleManager（运行时计算与缓存）
- [ ] 运行时 StyleManager：加载/切换主题/按层级合并
- [ ] 组件应用样式：将计算结果绑定到渲染属性
- [ ] 组件级样式覆盖（override 开关与覆盖作用域）
- [ ] 状态样式验证：hover / active / disabled（含模拟入口）

### M4：依赖与继承系统（可解释的样式来源）
- [ ] 实现主题继承：Dark 继承 Light（base 链合并）
- [ ] 实现样式继承/依赖关系（按层级覆盖规则）
- [ ] 生成可查询的“属性来源”信息（每个属性来自哪一层）

### M5：Style Inspector（核心调试能力）
- [ ] 点击组件获取最终计算结果（所有可编辑属性）
- [ ] 显示每个属性来自哪里（Global / Button / primary / hover 等）
- [ ] 显示继承链与覆盖关系（被 override 的值可见）
- [ ] 支持按属性搜索与按来源过滤

### M6：实时预览系统（所见即所得）
- [ ] 预览支持多布局（不同页面/容器组合）
- [ ] 预览支持多状态（hover/active/disabled/loading）
- [ ] 支持缩放与滚动
- [ ] 响应窗口变化（布局自适应验证）

### M7：主题管理（编辑器侧能力）
- [ ] 创建主题 / 删除主题 / 复制主题
- [ ] 切换主题（即时刷新预览）
- [ ] 主题继承可视化（base 链展示与冲突提示）

### M8：热加载 + 差异检测 + 局部刷新
- [ ] 监听样式文件变化（文件监控）
- [ ] 自动重新解析并生成 diff
- [ ] 根据 diff 做局部刷新（最小影响范围更新）
- [ ] 刷新稳定性验证（连续编辑/频繁保存/语法错误恢复）

## 编辑器 UI（目标布局）

- 组件树：`App → Button/Text/Input/Card/Modal ...`
- 中央：实时预览（多布局/多状态/可缩放/可滚动）
- 右侧：样式编辑面板（属性名 / 当前值 / 来源 / override 开关）

## 验收清单（必须可演示）

- [ ] 主题切换（Light/Dark/High-Contrast 至少 2 套可用）
- [ ] hover/active/disabled 状态样式可复现且来源可追踪
- [ ] 热加载保存后预览自动更新，且能说明 diff 与刷新范围
- [ ] Style Inspector 能展示：最终值、来源、继承链、被覆盖项

## 备注（待补齐）

- 统一属性 schema：当前需求文档中部分内容不可见，需要后续补齐字段清单与约束。
